# Generated by KD build system

CC=arm-none-eabi-gcc
CXX=arm-none-eabi-g++
OUTPUT=main
DEVICE=stm32f103

F_CPU=32000000
RAMSIZE=20480

DEFINES=-DETHERNET -DENC28J60_DEBUG -DSTM32F10X_MD -DPRINTF -DF_CPU=$(F_CPU) -DRAMSIZE=$(RAMSIZE)
INCLUDEPATH=-I. -I.. -I../providers -Ikdusb -Istm32-utils -Ikdulibs -I../kdutils -I../3rd/lwip-1.4.1/src/include/ -I../3rd/lwip-1.4.1/src/include/ipv4
LIBS=-lm -lc

CFLAGS=-mcpu=cortex-m3 -march=armv7-m -mfix-cortex-m3-ldrd -msoft-float -mthumb -nostartfiles -ggdb -Werror=implicit -Os -fdata-sections -ffunction-sections
CFLAGS+=$(DEFINES)
CFLAGS+=$(INCLUDEPATH)
CXXFLAGS=$(CFLAGS) 
LFLAGS=-Wl,--relax,--gc-sections -Wl,-gc-sections -Wl,-Map=build/$(OUTPUT).map -Wl,-T main.ld
LFLAGS+=$(LIBS)

all: prepare build/$(OUTPUT).elf build/$(OUTPUT).bin build/$(OUTPUT).hex
	arm-none-eabi-objdump -h -S build/$(OUTPUT).elf > build/$(OUTPUT).lst
	arm-none-eabi-size build/$(OUTPUT).elf

build/$(OUTPUT).bin: build/$(OUTPUT).elf
	arm-none-eabi-objcopy -O binary build/$(OUTPUT).elf build/$(OUTPUT).bin

build/$(OUTPUT).hex: build/$(OUTPUT).elf
	arm-none-eabi-objcopy -O ihex build/$(OUTPUT).elf build/$(OUTPUT).hex

prepare:
	mkdir -p build/

build/main.o: main.c
	$(CC) $(CFLAGS) -c $< -o $@

build/isr.o: isr.c
	$(CC) $(CFLAGS) -c $< -o $@

build/utils.o: utils.c
	$(CC) $(CFLAGS) -c $< -o $@

build/temp.o: temp.c
	$(CC) $(CFLAGS) -c $< -o $@

build/io.o: io.c
	$(CC) $(CFLAGS) -c $< -o $@

build/ir.o: ir.c
	$(CC) $(CFLAGS) -c $< -o $@

build/stm32-utils_delay.o: stm32-utils/delay.c
	$(CC) $(CFLAGS) -c $< -o $@

build/stm32-utils_myprintf.o: stm32-utils/myprintf.c
	$(CC) $(CFLAGS) -c $< -o $@

build/stm32-utils_i2c.o: stm32-utils/i2c.c
	$(CC) $(CFLAGS) -c $< -o $@

build/stm32-utils_ow.o: stm32-utils/ow.c
	$(CC) $(CFLAGS) -c $< -o $@

build/kdulibs_advinputmanager.o: kdulibs/advinputmanager.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_IRremote.o: ../3rd/IRremote.c
	$(CC) $(CFLAGS) -c $< -o $@

build/ethernet.o: ethernet.c
	$(CC) $(CFLAGS) -c $< -o $@

build/buffer.o: buffer.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__providers_providers.o: ../providers/providers.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__providers_provider_output.o: ../providers/provider_output.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__providers_provider_input.o: ../providers/provider_input.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__providers_provider_temp.o: ../providers/provider_temp.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__providers_provider_ir.o: ../providers/provider_ir.c
	$(CC) $(CFLAGS) -c $< -o $@

build/kdulibs_ENC28J60.o: kdulibs/ENC28J60.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_def.o: ../3rd/lwip-1.4.1/src/core/def.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_dhcp.o: ../3rd/lwip-1.4.1/src/core/dhcp.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_ipv4_inet.o: ../3rd/lwip-1.4.1/src/core/ipv4/inet.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_ipv4_inet_chksum.o: ../3rd/lwip-1.4.1/src/core/ipv4/inet_chksum.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_mem.o: ../3rd/lwip-1.4.1/src/core/mem.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_memp.o: ../3rd/lwip-1.4.1/src/core/memp.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_netif.o: ../3rd/lwip-1.4.1/src/core/netif.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_pbuf.o: ../3rd/lwip-1.4.1/src/core/pbuf.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_init.o: ../3rd/lwip-1.4.1/src/core/init.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_raw.o: ../3rd/lwip-1.4.1/src/core/raw.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_stats.o: ../3rd/lwip-1.4.1/src/core/stats.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_sys.o: ../3rd/lwip-1.4.1/src/core/sys.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_udp.o: ../3rd/lwip-1.4.1/src/core/udp.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_timers.o: ../3rd/lwip-1.4.1/src/core/timers.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_ipv4_inet.o: ../3rd/lwip-1.4.1/src/core/ipv4/inet.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_ipv4_icmp.o: ../3rd/lwip-1.4.1/src/core/ipv4/icmp.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_ipv4_ip.o: ../3rd/lwip-1.4.1/src/core/ipv4/ip.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_ipv4_ip_addr.o: ../3rd/lwip-1.4.1/src/core/ipv4/ip_addr.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_core_ipv4_ip_frag.o: ../3rd/lwip-1.4.1/src/core/ipv4/ip_frag.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_lwip-1.4.1_src_netif_etharp.o: ../3rd/lwip-1.4.1/src/netif/etharp.c
	$(CC) $(CFLAGS) -c $< -o $@

build/enc28j60if.o: enc28j60if.c
	$(CC) $(CFLAGS) -c $< -o $@

build/$(OUTPUT).elf: build/main.o build/isr.o build/utils.o build/temp.o build/io.o build/ir.o build/stm32-utils_delay.o build/stm32-utils_myprintf.o build/stm32-utils_i2c.o build/stm32-utils_ow.o build/kdulibs_advinputmanager.o build/__3rd_IRremote.o build/ethernet.o build/buffer.o build/__providers_providers.o build/__providers_provider_output.o build/__providers_provider_input.o build/__providers_provider_temp.o build/__providers_provider_ir.o build/kdulibs_ENC28J60.o build/__3rd_lwip-1.4.1_src_core_def.o build/__3rd_lwip-1.4.1_src_core_dhcp.o build/__3rd_lwip-1.4.1_src_core_ipv4_inet.o build/__3rd_lwip-1.4.1_src_core_ipv4_inet_chksum.o build/__3rd_lwip-1.4.1_src_core_mem.o build/__3rd_lwip-1.4.1_src_core_memp.o build/__3rd_lwip-1.4.1_src_core_netif.o build/__3rd_lwip-1.4.1_src_core_pbuf.o build/__3rd_lwip-1.4.1_src_core_init.o build/__3rd_lwip-1.4.1_src_core_raw.o build/__3rd_lwip-1.4.1_src_core_stats.o build/__3rd_lwip-1.4.1_src_core_sys.o build/__3rd_lwip-1.4.1_src_core_udp.o build/__3rd_lwip-1.4.1_src_core_timers.o build/__3rd_lwip-1.4.1_src_core_ipv4_inet.o build/__3rd_lwip-1.4.1_src_core_ipv4_icmp.o build/__3rd_lwip-1.4.1_src_core_ipv4_ip.o build/__3rd_lwip-1.4.1_src_core_ipv4_ip_addr.o build/__3rd_lwip-1.4.1_src_core_ipv4_ip_frag.o build/__3rd_lwip-1.4.1_src_netif_etharp.o build/enc28j60if.o
	$(CC) $^ $(CXXFLAGS) $(LFLAGS) -o $@

clean:
	rm -f build/$(OUTPUT).{elf,bin,hex,lst,map} build/main.o build/isr.o build/utils.o build/temp.o build/io.o build/ir.o build/stm32-utils_delay.o build/stm32-utils_myprintf.o build/stm32-utils_i2c.o build/stm32-utils_ow.o build/kdulibs_advinputmanager.o build/__3rd_IRremote.o build/ethernet.o build/buffer.o build/__providers_providers.o build/__providers_provider_output.o build/__providers_provider_input.o build/__providers_provider_temp.o build/__providers_provider_ir.o build/kdulibs_ENC28J60.o build/__3rd_lwip-1.4.1_src_core_def.o build/__3rd_lwip-1.4.1_src_core_dhcp.o build/__3rd_lwip-1.4.1_src_core_ipv4_inet.o build/__3rd_lwip-1.4.1_src_core_ipv4_inet_chksum.o build/__3rd_lwip-1.4.1_src_core_mem.o build/__3rd_lwip-1.4.1_src_core_memp.o build/__3rd_lwip-1.4.1_src_core_netif.o build/__3rd_lwip-1.4.1_src_core_pbuf.o build/__3rd_lwip-1.4.1_src_core_init.o build/__3rd_lwip-1.4.1_src_core_raw.o build/__3rd_lwip-1.4.1_src_core_stats.o build/__3rd_lwip-1.4.1_src_core_sys.o build/__3rd_lwip-1.4.1_src_core_udp.o build/__3rd_lwip-1.4.1_src_core_timers.o build/__3rd_lwip-1.4.1_src_core_ipv4_inet.o build/__3rd_lwip-1.4.1_src_core_ipv4_icmp.o build/__3rd_lwip-1.4.1_src_core_ipv4_ip.o build/__3rd_lwip-1.4.1_src_core_ipv4_ip_addr.o build/__3rd_lwip-1.4.1_src_core_ipv4_ip_frag.o build/__3rd_lwip-1.4.1_src_netif_etharp.o build/enc28j60if.o

.PHONY: prepare clean flash
